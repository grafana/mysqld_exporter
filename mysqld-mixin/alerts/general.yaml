groups:
- name: MySQLdAlerts
  rules:
  - alert: MySQLDown
    expr: mysql_up != 1
    for: 5m
    labels:
      severity: critical
    annotations:
      description: 'MySQL {{$labels.job}} on {{$labels.instance}} is not up.'
      summary: MySQL not up.
  - alert: MysqlRestarted
    expr: mysql_global_status_uptime < 60
    labels:
      severity: critical
    annotations:
      description: 'MySQL {{$labels.job}} on {{$labels.instance}} restarted less than a minute ago.'
      summary: MySQL restarted.
  - alert: MysqlSlowQueries
    expr: rate(mysql_global_status_slow_queries[5m]) * 60 > 0
    for: 2m
    labels:
      severity: warning
    annotations:
      description: 'MySQL {{$labels.job}} on {{$labels.instance}} is facing slow queries.'
      summary: MySQL slow queries.
  - alert: TuneThreadCacheSize
    expr: mysql_global_status_threads_created / mysql_global_status_connections > 0.5
    for: 5m
    labels:
      severity: warning
    annotations:
      description: 'MySQL {{$labels.job}} on {{$labels.instance}} thread cache needs tuning.'
      summary: MySQL thread cache needs tuning.
  - alert: InsufficientTempTableSize
    expr: mysql_global_status_created_tmp_disk_tables / mysql_global_status_created_tmp_tables > 0.2
    for: 5m
    labels:
      severity: warning
    annotations:
      description: 'MySQL {{$labels.job}} on {{$labels.instance}} has insufficient temp table size.'
      summary: MySQL temp table size insufficient.
  - alert: InsufficientBinLogCacheSize
    expr: mysql_global_status_binlog_cache_disk_use / mysql_global_status_binlog_cache_use > 0.2
    for: 5m
    labels:
      severity: warning
    annotations:
      description: 'MySQL {{$labels.job}} on {{$labels.instance}} has insufficient binary log cache size.'
      summary: MySQL binary log cache size insufficient.
  - alert: InsufficientBinLogStmtCacheSize
    expr: mysql_global_status_binlog_stmt_cache_disk_use / mysql_global_status_binlog_stmt_cache_use > 0.2
    for: 5m
    labels:
      severity: warning
    annotations:
      description: 'MySQL {{$labels.job}} on {{$labels.instance}} has insufficient binary log statement cache size.'
      summary: MySQL binary log statement cache size insufficient.

